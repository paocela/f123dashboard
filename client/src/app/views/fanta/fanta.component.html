<div>
    <c-container class="m-2">
        <c-row>
            <c-col xs="auto" class="me-auto">
                <h1>Ciao {{username}}</h1>
            </c-col>
            <c-col xs="auto">
                <div class="align">
                    <button cButton
                    (click)="this.logout()"
                    >
                    Logout
                    </button>
                </div>
            </c-col>
        </c-row>
    </c-container>
    <c-container>
        <c-row class="justify-content-md-center">
            <h1 class="mt-4">Fanta Ufficiale del Campionato F1 Online 2024-2025</h1>
            <p class="lead">Qui puoi inserire le votazioni per ogni gp che verr√† disputato</p>
        </c-row>
        <c-row>
              <c-accordion>
                <c-accordion-item 
                    #item0="cAccordionItem" 
                    [visible]="false"
                    *ngFor="let track of nextTracks"
                >
                <strong>{{track.track_name}}</strong>
                  <ng-template cTemplateId="accordionHeaderTemplate">
                    <button (click)="item0.toggleItem()" [collapsed]="!item0.visible" cAccordionButton>
                        <c-container>
                            <c-row>
                                <c-col xs="auto" class="me-auto">
                                    <h5 class="card-title mb-0" id="traffic">
                                        <svg class="mx-1" size='lg' [cIcon]="allFlags[track.country]"></svg>
                                        <strong>{{track.name}}</strong>
                                        <svg class="mx-1" size='lg' [cIcon]="allFlags[track.country]"></svg>
                                    </h5>
                                </c-col>
                                <c-col xs="auto">
                                    <div class="small">{{track.date | date: 'dd/MM/yyyy'}}</div>
                                </c-col>
                            </c-row>
                        </c-container>
                    </button>
                  </ng-template>
                  <ng-template cTemplateId="accordionBodyTemplate">
                    <div class="accordion-body">
                        <form cForm (ngSubmit)="onVoto(track.track_id)">
                            <c-container>
                                <c-row *ngFor="let posizione of posizioni | keyvalue" class="m-2">
                                    <c-col xs="8">
                                        seleziona il {{posizione?.value}} 
                                        <img *ngIf="posizione.key<=3" 
                                        class="cIcon" 
                                        style="width: 25px;"
                                        attr.src="assets/medals/{{medals.get(posizione.key)}}">  
                                    </c-col>
                                    <c-col>
                                        <select attr.aria-label="seleziona il pilota che arrivera {{posizione?.value}}" 
                                        attr.id="{{track.track_id+posizione.key}}" 
                                        [(ngModel)]="voto[posizione.key]" 
                                        name="voto{{track.track_id+posizione.key}}"
                                        cSelect
                                        >
                                            <option>Seleziona il Pilota</option>
                                            <option *ngFor="let pilota of piloti" 
                                            attr.value="{{pilota.driver_id}}"
                                            >
                                                {{pilota.driver_username}}
                                            </option>
                                        </select>
                                    </c-col>
                                </c-row>
                                <c-row>
                                    <input cButton type="submit" color="">
                                </c-row>
                            </c-container>
                        </form>
                    </div>
                  </ng-template>
                </c-accordion-item>
              </c-accordion>
        </c-row>
    </c-container>  
    
</div>